Статистический анализ данных

Вам передали данные популярного сервиса аренды самокатов **GoFast** о некоторых пользователях из нескольких городов, а также об их поездках.  
Ваша задача — проанализировать данные и проверить гипотезы, которые могут помочь бизнесу вырасти.

Пользователи сервиса совершают поездки через мобильное приложение. Сервисом можно пользоваться:

- **Без подписки**  
  - Абонентская плата отсутствует  
  - Стоимость одной минуты поездки — 8 рублей  
  - Стоимость старта (начала поездки) — 50 рублей  

- **С подпиской Ultra**  
  - Абонентская плата — 199 рублей в месяц  
  - Стоимость одной минуты поездки — 6 рублей  
  - Стоимость старта — бесплатно  

---

## Описание данных

### Пользователи — `users_go.csv`

| Столбец             | Описание                                    |
|--------------------|--------------------------------------------|
| user_id            | уникальный идентификатор пользователя      |
| name               | имя пользователя                            |
| age                | возраст                                     |
| city               | город                                       |
| subscription_type  | тип подписки (`free`, `ultra`)             |

### Поездки — `rides_go.csv`

| Столбец   | Описание                                                                                   |
|-----------|-------------------------------------------------------------------------------------------|
| user_id   | уникальный идентификатор пользователя                                                     |
| distance  | расстояние, которое пользователь проехал в текущей сессии (в метрах)                      |
| duration  | продолжительность сессии (в минутах) — время от начала до завершения поездки             |
| date      | дата совершения поездки                                                                    |

### Подписки — `subscriptions_go.csv`

| Столбец           | Описание                                                  |
|------------------|----------------------------------------------------------|
| subscription_type | тип подписки                                             |
| minute_price      | стоимость одной минуты поездки по данной подписке       |
| start_ride_price  | стоимость начала поездки                                  |
| subscription_fee  | стоимость ежемесячного платежа                           |

---

## Шаг 1. Загрузка данных

1. Считайте CSV-файлы с данными с помощью `pandas` и сохраните их в датафреймы.  
   Пути к файлам:  
   - `/datasets/users_go.csv`  
   - `/datasets/rides_go.csv`  
   - `/datasets/subscriptions_go.csv`  

2. Выведите первые строки каждого набора данных и изучите общую информацию о каждом датафрейме.

---

## Шаг 2. Предобработка данных

1. Приведите столбец `date` к типу даты `pandas`.  
2. Создайте новый столбец с номером месяца на основе столбца `date`.  
3. Проверьте наличие пропущенных значений и дубликатов в датафреймах и обработайте их, если такие значения присутствуют.

---

## Шаг 3. Исследовательский анализ данных

Опишите и визуализируйте общую информацию о пользователях и поездках:

1. Частота встречаемости городов  
2. Соотношение пользователей с подпиской и без подписки  
3. Возраст пользователей  
4. Расстояние, которое пользователь преодолел за одну поездку  
5. Продолжительность поездок

---

## Шаг 4. Объединение данных

1. Объедините данные о пользователях, поездках и подписках в один датафрейм (`merge()`).  
2. Создайте два новых датафрейма:  
   - С данными о пользователях **без подписки**  
   - С данными о пользователях **с подпиской**  
3. Визуализируйте информацию о расстоянии и времени поездок для пользователей обеих категорий.

---

## Шаг 5. Подсчёт выручки

1. Создайте датафрейм с агрегированными данными о поездках на основе объединённого датафрейма из шага 4:  
   - Найдите суммарное расстояние, количество поездок и суммарное время для каждого пользователя за каждый месяц.  

2. Добавьте столбец с помесячной выручкой каждого пользователя:  
   - Используйте условия оплаты для подписчиков и пользователей без подписки.  
   - Продолжительность каждой поездки округляется до следующего целого числа (например, 25.3 → 26).

---

## Шаг 6. Проверка гипотез

Продакт-менеджеры сервиса хотят увеличить количество пользователей с подпиской. Для этого необходимо проверить следующие гипотезы:

1. **Время поездок подписчиков**  
   - Тратят ли пользователи с подпиской больше времени на поездки?  
   - Используйте исходные данные о продолжительности каждой сессии отдельно для подписчиков и тех, у кого нет подписки.  

2. **Оптимальное расстояние поездки**  
   - Расстояние одной поездки в 3130 метров — оптимальное с точки зрения износа самоката.  
   - Проверить, что среднее расстояние пользователей с подпиской за одну поездку не превышает 3130 м.  

3. **Выручка подписчиков vs. обычных пользователей**  
   - Будет ли помесячная выручка от пользователей с подпиской выше, чем от пользователей без подписки?  

4. **Влияние обновления серверов на обращения в техподдержку**  
   - Если техническая команда обновила серверы, снизилось ли количество обращений в техподдержку?  
   - Какой тест нужен для проверки этой гипотезы?

