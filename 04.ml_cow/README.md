# Прогнозирование удоя покупаемых коров

## Описание проекта

Вы работаете в IT-компании, которая выполняет на заказ проекты по машинному обучению. К вам обратился фермер, владелец молочного хозяйства «Вольный луг». Он хочет купить бурёнок, чтобы расширить поголовье стада коров. Для этого он заключил выгодный контракт с ассоциацией пастбищ «ЭкоФерма».

Условия позволяют фермеру очень тщательно отобрать коров. Он определяет качество молока по строгой методике, и при этом ему нужно выполнять свой план развития молочного хозяйства. Фермер хочет, чтобы каждая бурёнка давала не менее 6000 килограммов молока в год, а её надой был вкусным — строго по его критериям, ничуть не хуже. А продавцы и технологи так и норовят приукрасить своих коровок!

Поэтому он просит вас разработать модель машинного обучения, которая поможет ему управлять рисками и принимать объективное решение о покупке. «ЭкоФерма» готова предоставить подробные данные о своих коровах. Вам нужно создать две прогнозные модели для отбора бурёнок в поголовье:

1. Первая будет прогнозировать возможный удой коровы (целевой признак **Удой**);
2. Вторая — рассчитывать вероятность получить вкусное молоко от коровы (целевой признак **Вкус молока**).

С помощью модели нужно отобрать коров по двум критериям:

- средний удой за год — не менее 6000 килограммов;
- молоко должно быть вкусным.

## Описание данных

Вы будете работать с тремя датасетами:

- `ferma_main.csv`
- `ferma_dad.csv`
- `cow_buy.csv`

Вы можете их скачать, нажав на название каждого.

### Файл `ferma_main.csv`

Содержит данные о стаде фермера на текущий момент. Описание данных:

- `id` — уникальный идентификатор коровы.
- `Удой, кг` — масса молока, которую корова даёт в год (в килограммах).
- `ЭКЕ (Энергетическая кормовая единица)` — показатель питательности корма коровы.
- `Сырой протеин, г` — содержание сырого протеина в корме (в граммах).
- `СПО (Сахаро-протеиновое соотношение)` — отношение сахара к протеину в корме коровы.
- `Порода` — порода коровы.
- `Тип пастбища` — ландшафт лугов, на которых паслась корова.
- `порода папы_быка` — порода папы коровы.
- `Жирность,%` — содержание жиров в молоке (в процентах).
- `Белок,%` — содержание белков в молоке (в процентах).
- `Вкус молока` — оценка вкуса по личным критериям фермера, бинарный признак (вкусно, не вкусно).
- `Возраст` — возраст коровы, бинарный признак (менее_2_лет, более_2_лет).

Признаки в датасете `ferma_main.csv` можно разделить на группы:

- **Характеристики коровы:** `id`, `Порода`, `порода папы_быка`, `Возраст`.
- **Характеристики корма:** `ЭКЕ (Энергетическая кормовая единица)`, `Сырой протеин, г`, `СПО (Сахаро-протеиновое соотношение)`.
- **Характеристика пастбища:** `Тип пастбища`.
- **Характеристики молока:** `Удой, кг`, `Жирность,%`, `Белок,%`, `Вкус молока`.

### Файл `ferma_dad.csv`

Хранит имя папы каждой коровы в стаде фермера. Описание данных:

- `id` — уникальный идентификатор коровы.
- `Имя Папы` — имя папы коровы.

### Файл `cow_buy.csv`

Данные о коровах «ЭкоФермы», которых фермер хочет изучить перед покупкой. Описание данных:

- `Порода` — порода коровы.
- `Тип пастбища` — ландшафт лугов, на которых паслась корова.
- `порода папы_быка` — порода папы коровы.
- `Имя_папы` — имя папы коровы.
- `Текущая_жирность,%` — содержание жиров в молоке (в процентах).
- `Текущий_уровень_белок,%` — содержание белков в молоке (в процентах).
- `Возраст` — возраст коровы, бинарный признак (менее_2_лет, более_2_лет).

Особенности `cow_buy.csv`:

- Содержание белков и жиров указано на момент продажи.
- Параметры корма (`ЭКЕ`, `Сырой протеин, г`, `СПО`) отсутствуют. Планируется увеличить их значения на 5%.
- Отсутствуют признаки `Удой, кг` и `Вкус молока` — их предстоит предсказать.


### Шаг 1. Загрузите и изучите данные

- Загрузите данные в датафреймы `pandas`.  
  Пути к файлам:
  - `/datasets/ferma_main.csv`
  - `/datasets/ferma_dad.csv`
  - `/datasets/cow_buy.csv`

- Изучите данные, соответствуют ли они описанию и стандартам оформления. При необходимости переименуйте столбцы.

### Шаг 2. Предобработка данных

- Проверьте данные на пропуски и дубликаты.
- Убедитесь, что типы данных корректны. При необходимости устраните проблемы.

### Шаг 3. Исследовательский анализ данных

- Проведите статистический анализ всех признаков.
- Постройте графики для каждого признака.
- Сделайте выводы:
  - есть ли выбросы или необычные распределения;
  - как планируете улучшить данные.

### Шаг 4. Корреляционный анализ признаков

- Рассчитайте коэффициенты корреляции между всеми признаками в `ferma_main.csv`.
- Постройте scatterplot для `Удой, кг` и всех количественных признаков с учётом категориальных.
- Сделайте выводы о взаимосвязи признаков:
  - тип взаимосвязи между целевым и входными признаками;
  - наличие нелинейных связей;
  - наблюдается ли мультиколлинеарность.

### Шаг 5. Задача регрессии

- Обучите три модели простой линейной регрессии:
  1. Первая модель: `LinearRegression`, целевой признак `Удой, кг`.
  2. Вторая модель: устранение нелинейности (`СПО`, `ЭКЕ`), добавление новых признаков.
  3. Третья модель: добавление признака `Имя Папы`, устранение нелинейности.

- Для каждой модели:
  - Разбейте данные на тренировочную и тестовую выборки.
  - Кодируйте категориальные признаки `OneHotEncoder`.
  - Масштабируйте количественные признаки `StandardScaler`.
  - Оцените качество: `R²`, остатки, MSE, MAE, RMSE.
  - Сделайте выводы.

- Используйте лучшую модель, чтобы спрогнозировать удой коров из `cow_buy.csv`:
  - Добавьте недостающие признаки ЭКЕ, Сырой протеин, СПО (средние +5%).
  - Подготовьте данные аналогично тренировочной выборке.
  - Получите прогноз удоя.

### Шаг 6. Задача классификации

- Обучите модель `LogisticRegression` на `ferma_main.csv`.
- Целевой признак — `Вкус молока`.
- При необходимости преобразуйте или добавьте признаки.
- Разбейте на тренировочную и тестовую выборки.
- Кодируйте категориальные признаки `OneHotEncoder`.
- Масштабируйте количественные признаки `StandardScaler`.
- Оцените качество:
  - Метрики: `accuracy`, `recall`, `precision`
  - Постройте матрицу ошибок.
- Проанализируйте модель:
  - Какая ошибка критичнее при покупке коров?
  - Сведите критичную ошибку к нулю, изменив порог классов.
  - Оформите выводы.

- Прогнозируйте вкус молока коров из `cow_buy.csv`.

### Шаг 7. Итоговые выводы

- Добавьте прогнозы удоя и вкуса молока в датафрейм с рассматриваемыми коровами.
- Отберите коров с удоем > 6000 кг и вкусным молоком.
- Коротко опишите результаты:
  - Сколько коров можно купить с минимальным риском?
  - Какие рекомендации дать фермеру?
- Сделайте выводы о моделях линейной и логистической регрессии:
  - Способы улучшения качества модели.
  - Возможности дальнейшего улучшения.
  - Важные метрики для анализа рисков и экономических расчётов.
